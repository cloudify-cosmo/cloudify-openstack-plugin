tosca_definitions_version: cloudify_dsl_1_3

imports:
  - https://raw.githubusercontent.com/cloudify-cosmo/cloudify-manager/4.2/resources/rest-service/cloudify/types/types.yaml
  - ../plugin.yaml

inputs:
  stack_template:
    default: stack_template.yaml
  keystone_username:
  keystone_password:
  keystone_tenant_name:
  keystone_url:
  region:

dsl_definitions:

  openstack_config: &openstack_config
    username: { get_input: keystone_username }
    password: { get_input: keystone_password }
    tenant_name: { get_input: keystone_tenant_name }
    auth_url: { get_input: keystone_url }
    region: { get_input: region }      

node_templates:

  heat_stack:
    type: cloudify.openstack.nodes.Stack
    properties:      
      openstack_config: *openstack_config
      template_file: {get_input: stack_template }
      stack:
        parameters:
          network_id: network1
